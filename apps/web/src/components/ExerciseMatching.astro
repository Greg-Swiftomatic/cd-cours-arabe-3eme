---
interface Props {
  id: string;
  question: string;
  pairs: Array<{ left: string; right: string }>;
  feedback: {
    correct: string;
    incorrect: string;
  };
}

const { id, question, pairs, feedback } = Astro.props;
const shuffledRights = [...pairs.map(p => p.right)].sort(() => Math.random() - 0.5);
---

<div class="exercise-item mb-6" data-exercise-id={id}>
  <div class="bg-gray-50 border border-gray-200 rounded-xl p-5">
    <p class="text-lg font-semibold text-gray-900 mb-4">{question}</p>

    <div class="grid md:grid-cols-2 gap-4">
      <!-- Left column -->
      <div class="space-y-3">
        {pairs.map((pair, index) => (
          <div class="flex items-center gap-2">
            <div class="flex-1 p-3 bg-white border-2 border-gray-300 rounded-lg font-semibold text-gray-900">
              {pair.left}
            </div>
            <select
              name={`${id}-${index}`}
              data-correct={pair.right}
              class="px-3 py-3 border-2 border-gray-300 rounded-lg focus:border-primary-500 focus:ring-2 focus:ring-primary-200 text-gray-900"
            >
              <option value="">اختر</option>
              {shuffledRights.map((right) => (
                <option value={right}>{right}</option>
              ))}
            </select>
          </div>
        ))}
      </div>
    </div>

    <!-- Feedback area -->
    <div class="feedback hidden mt-4 p-4 rounded-lg" data-feedback>
      <div class="flex items-start gap-3">
        <svg class="feedback-icon h-6 w-6 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"></svg>
        <div>
          <p class="feedback-title font-semibold mb-1"></p>
          <p class="feedback-message text-sm"></p>
        </div>
      </div>
    </div>

    <button
      class="check-answer-btn mt-4 rounded-full bg-primary-600 px-6 py-2 text-sm font-semibold text-white shadow-md transition hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed"
      data-correct-feedback={feedback.correct}
      data-incorrect-feedback={feedback.incorrect}
    >
      تحقق من الإجابة
    </button>
  </div>
</div>
